# ä¸­å›½æ–°å† ç—…æ¯’é¢„æµ‹ä¸­å¿ƒ

è¿™ä¸ªåä½œé¢„æµ‹å¹³å°æ”¶é›†å’Œè¯„ä¼°æ¥è‡ªä¸­å›½å“¨ç‚¹åŒ»é™¢çš„æµæ„Ÿæ ·ç—…ä¾‹ä¸­SARS-CoV-2é˜³æ€§ç‡çš„å®æ—¶é¢„æµ‹ã€‚è¯¥å¹³å°ä¸ºæ¯”è¾ƒé¢„æµ‹æ¨¡å‹ã€ä¸ºå…¬å…±å«ç”Ÿå†³ç­–æä¾›å¾ªè¯è§è§£ã€‚ä»»ä½•æœ‰å…´è¶£å°†è¿™äº›æ•°æ®ç”¨äºå…¶ä»–ç ”ç©¶æˆ–å‘è¡¨çš„äººå‘˜ï¼Œè¯·è”ç³» yang_kaixin@gzlab.ac.cn è·å–å…³äºæ•°æ®æºå½’å±çš„ä¿¡æ¯ã€‚

## æ¯å‘¨SARS-CoV-2é˜³æ€§ç‡é¢„æµ‹

æœ¬ä¸­å¿ƒä¸“æ³¨äºé¢„æµ‹æ¥è‡ªä¸­å›½å“¨ç‚¹åŒ»é™¢ç›‘æµ‹ç½‘ç»œçš„æ¯å‘¨æµæ„Ÿæ ·ç—…ä¾‹ä¸­SARS-CoV-2é˜³æ€§ç‡ã€‚é¢„æµ‹æä¾›ç”¨äºå›é¡¾æ€§åˆ†æï¼ˆç°æŠ¥å‘Šï¼‰å’Œæœªæ¥é¢„æµ‹çš„æ¦‚ç‡æ€§é¢„æµ‹ã€‚

**æäº¤æ—¶é—´ï¼š** é¢„æµ‹æäº¤æœŸä»2025å¹´8æœˆ21æ—¥å¼€å§‹ï¼Œå°†æ— é™æœŸæŒç»­ã€‚è¦æ±‚å‚ä¸è€…æ¯å‘¨**åŒ—äº¬æ—¶é—´å‘¨ä¸‰23:59**ä¹‹å‰æäº¤é¢„æµ‹ï¼ˆä»¥ä¸‹ç§°ä¸ºé¢„æµ‹æäº¤æˆªæ­¢æ—¥æœŸï¼‰ã€‚å¦‚æœæ•°æ®å¯ç”¨æ€§æ—¶é—´è¡¨å‘ç”Ÿå˜åŒ–ï¼Œä¸­å›½æ–°å† ç—…æ¯’é¢„æµ‹ä¸­å¿ƒå¯èƒ½ä¼šæ›´æ”¹é¢„æµ‹æäº¤çš„æˆªæ­¢æ—¥æœŸã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‚ä¸è€…å°†è‡³å°‘æå‰ä¸€å‘¨æ”¶åˆ°é€šçŸ¥ã€‚æ¯å‘¨æäº¤ï¼ˆåŒ…æ‹¬æ–‡ä»¶åï¼‰å°†ä»¥å‚è€ƒæ—¥æœŸä¸ºå‡†ï¼Œå‚è€ƒæ—¥æœŸæ˜¯é¢„æµ‹æäº¤æˆªæ­¢æ—¥æœŸä¹‹åçš„å‘¨å…­ã€‚å‚è€ƒæ—¥æœŸæ˜¯åŒ…å«é¢„æµ‹æäº¤æˆªæ­¢æ—¥æœŸçš„æµè¡Œç—…å­¦å‘¨ï¼ˆEWï¼‰ï¼ˆå‘¨æ—¥è‡³å‘¨å…­ï¼‰çš„æœ€åä¸€å¤©ã€‚

**é¢„æµ‹ç›®æ ‡ï¼š**
å‚ä¸å›¢é˜Ÿéœ€è¦æä¾›å…¨å›½èŒƒå›´å†…ä»¥ä¸‹ç›®æ ‡çš„é¢„æµ‹ï¼š
**"wk inc covid prop ili"** ï¼ˆæ¯å‘¨æµæ„Ÿæ ·ç—…ä¾‹ä¸­æ–°å† ç—…æ¯’å‘ç”Ÿç‡æ¯”ä¾‹ï¼‰ã€‚

å›¢é˜Ÿéœ€è¦æäº¤æˆªè‡³å‚è€ƒæ—¥æœŸçš„æµè¡Œç—…å­¦å‘¨ï¼ˆEWï¼‰ä»¥åŠ**-3è‡³+6å‘¨**èŒƒå›´å†…å„æ—¶é—´è·¨åº¦çš„æ¦‚ç‡æ€§é¢„æµ‹ã€‚å›¢é˜Ÿå¯ä»¥ä½†ä¸æ˜¯å¿…é¡»æäº¤æ‰€æœ‰å‘¨æ—¶é—´è·¨åº¦çš„é¢„æµ‹ã€‚é¢„æµ‹çš„è¯„ä¼°æ•°æ®å°†æ¥è‡ªä¸­å›½ç–¾æ§ä¸­å¿ƒå“¨ç‚¹åŒ»é™¢ç›‘æµ‹ç³»ç»Ÿçš„SARS-CoV-2é˜³æ€§ç‡å‘¨æ±‡æ€»æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨[CDC](https://wwwn.cdc.gov/nndss/document/MMWR_Week_overview.pdf)å®šä¹‰çš„æµè¡Œç—…å­¦å‘¨è§„èŒƒï¼Œå³å‘¨æ—¥è‡³å‘¨å…­ã€‚é¢„æµ‹çš„ç›®æ ‡ç»“æŸæ—¥æœŸæ˜¯æ„Ÿå…´è¶£çš„æµè¡Œç—…å­¦å‘¨ç»“æŸçš„å‘¨å…­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¡¨è¾¾å¼è®¡ç®—ï¼š
**ç›®æ ‡ç»“æŸæ—¥æœŸ = å‚è€ƒæ—¥æœŸ + æ—¶é—´è·¨åº¦ * (7å¤©)**ã€‚

æœ‰æ ‡å‡†çš„è½¯ä»¶åŒ…å¯ä»¥åœ¨æ—¥æœŸå’Œæµè¡Œç—…å­¦å‘¨ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼ˆ*ä¾‹å¦‚*ï¼ŒRè¯­è¨€çš„[MMWRweek](https://cran.r-project.org/web/packages/MMWRweek/)å’Œ[lubridate](https://lubridate.tidyverse.org/reference/week.html)ï¼ŒPythonçš„[pymmwr](https://pypi.org/project/pymmwr/)å’Œ[epiweeks](https://pypi.org/project/epiweeks/)ï¼‰ã€‚

å¦‚æœæ‚¨å¯¹æ­¤ç›®æ ‡æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·è”ç³»ï¼ˆyang_kaixin@gzlab.ac.cnï¼‰ã€‚

## æ•°æ®æ¥æº

### ç›®æ ‡æ•°æ®æ”¶é›†
é¢„æµ‹ç›®æ ‡æ•°æ®æ¥è‡ª**ä¸­å›½ç–¾æ§ä¸­å¿ƒæ¯å‘¨æ€¥æ€§å‘¼å¸é“ä¼ æŸ“ç—…ç›‘æµ‹æŠ¥å‘Š**ï¼Œè¦†ç›–å…¨å›½å“¨ç‚¹åŒ»é™¢ã€‚å†å²ç›‘æµ‹æ•°æ®å¯ä»è‡ªåŠ¨åŒ–æ•°æ®æ”¶é›†ç³»ç»Ÿè·å–ï¼š

**ğŸ”— [ä¸­å›½ç–¾æ§ä¸­å¿ƒçˆ¬è™«ä»“åº“](https://github.com/dailypartita/cn_cdc_crawl)**

è¯¥ä»“åº“æä¾›è‡ªåŠ¨ä¸‹è½½ã€å¤„ç†å’Œæå–ä¸­å›½ç–¾æ§ä¸­å¿ƒå‘¨æŠ¥ç»“æ„åŒ–ç›‘æµ‹æ•°æ®çš„å·¥å…·ï¼ŒåŒ…æ‹¬ï¼š
- ç›‘æµ‹æŠ¥å‘Šçš„PDFè½¬æ–‡æœ¬è½¬æ¢
- è‡ªåŠ¨æå–ç—…åŸä½“æ£€æµ‹ç‡
- SARS-CoV-2ã€æµæ„Ÿå’Œå…¶ä»–å‘¼å¸é“ç—…åŸä½“çš„æ—¶é—´åºåˆ—æ•°æ®
- é—¨è¯Šæµæ„Ÿæ ·ç—…ä¾‹å’Œä½é™¢ä¸¥é‡æ€¥æ€§å‘¼å¸é“æ„ŸæŸ“ç›‘æµ‹æ•°æ®

æå–çš„æ•°æ®éµå¾ªä»¥ä¸‹æ ¼å¼ï¼š
- **report_date**: æŠ¥å‘Šå‘å¸ƒæ—¥æœŸ
- **report_week**: æµè¡Œç—…å­¦å‘¨ï¼ˆYYYY-WWæ ¼å¼ï¼‰
- **pathogen**: ç—…åŸä½“åç§°ï¼ˆåŒ…æ‹¬æ–°å‹å† çŠ¶ç—…æ¯’/SARS-CoV-2ï¼‰
- **ili_percent**: æµæ„Ÿæ ·ç—…ä¾‹é˜³æ€§ç‡ï¼ˆ%ï¼‰
- **sari_percent**: ä¸¥é‡æ€¥æ€§å‘¼å¸é“æ„ŸæŸ“ç—…ä¾‹é˜³æ€§ç‡ï¼ˆ%ï¼‰

## æ¨¡å‹å¼€å‘ä¸è¯„ä¼°è§„èŒƒ

### æ•°æ®ä½¿ç”¨ä¸æ¨¡å‹å®Œæ•´æ€§æŒ‡å¯¼åŸåˆ™

ä¸ºç¡®ä¿æ¨¡å‹è¯„ä¼°çš„ç§‘å­¦æ€§å’Œå…¬å¹³æ€§ï¼Œæˆ‘ä»¬å»ºè®®å‚ä¸å›¢é˜Ÿåœ¨æ¨¡å‹å¼€å‘è¿‡ç¨‹ä¸­éµå¾ªä»¥ä¸‹æ•°æ®ä½¿ç”¨å‡†åˆ™ï¼š

#### **è®­ç»ƒæ•°æ®æ—¶é—´è¾¹ç•Œ**
- **å»ºè®®åšæ³•**ï¼šæ¨¡å‹è®­ç»ƒæ—¶è¯·é¿å…ä½¿ç”¨å½“å‰å‚è€ƒæ—¥æœŸåŠå…¶å‰ä¸‰å‘¨çš„ç›‘æµ‹æ•°æ®ï¼ˆå³æ—¶é—´è·¨åº¦ -3ã€-2ã€-1ã€0 å¯¹åº”çš„å®é™…è§‚æµ‹å€¼ï¼‰
- **è¯„ä¼°è®¾è®¡**ï¼šè¿™äº›æ—¶é—´çª—å£çš„æ•°æ®å°†ä½œä¸ºæµ‹è¯•é›†ï¼Œç”¨äºå®¢è§‚è¯„ä¼°å„æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½
- **ç§‘å­¦åŸç†**ï¼šæ­¤è®¾è®¡æ¨¡æ‹ŸçœŸå®ä¸–ç•Œé¢„æµ‹åœºæ™¯ï¼Œå…¶ä¸­æ¨¡å‹éœ€è¦åŸºäºå†å²æ•°æ®é¢„æµ‹æœªæ¥å’Œè¿‘æœŸè¶‹åŠ¿

#### **æ•°æ®å®Œæ•´æ€§ç›‘ç£**
- **è´¨é‡ä¿è¯**ï¼šæˆ‘ä»¬å°†å®šæœŸå®¡æŸ¥æäº¤çš„æ¨¡å‹é¢„æµ‹ï¼Œä»¥ç¡®ä¿éµå¾ªæœ€ä½³å»ºæ¨¡å®è·µ
- **åé¦ˆæœºåˆ¶**ï¼šå¦‚å‘ç°æ½œåœ¨çš„æ•°æ®æ—¶é—´æ€§ä½¿ç”¨é—®é¢˜ï¼Œæˆ‘ä»¬å°†ä¸ç›¸å…³å›¢é˜Ÿæ²Ÿé€šå¹¶æä¾›æ”¹è¿›å»ºè®®
- **æŒç»­æ”¹è¿›**ï¼šåŸºäºé€æ˜çš„è¯„ä¼°åŸåˆ™ï¼Œæˆ‘ä»¬è‡´åŠ›äºç»´æŠ¤ä¸€ä¸ªå…¬å¹³ã€ç§‘å­¦çš„é¢„æµ‹æ¯”è¾ƒç¯å¢ƒ

#### **æœ€ä½³å®è·µå»ºè®®**
- **äº¤å‰éªŒè¯**ï¼šæ¨èåœ¨å†å²æ•°æ®ä¸Šä½¿ç”¨æ»šåŠ¨çª—å£äº¤å‰éªŒè¯æ¥è¯„ä¼°æ¨¡å‹ç¨³å®šæ€§
- **ç‰¹å¾å·¥ç¨‹**ï¼šé¼“åŠ±ä½¿ç”¨æ»åç‰¹å¾å’Œå¤–éƒ¨æ•°æ®æºæ¥æé«˜é¢„æµ‹å‡†ç¡®æ€§
- **ä¸ç¡®å®šæ€§é‡åŒ–**ï¼šå»ºè®®æ¨¡å‹è¾“å‡ºåŒ…å«å……åˆ†çš„ä¸ç¡®å®šæ€§ä¿¡æ¯ä»¥æ”¯æŒå†³ç­–

> **ğŸ’¡ æç¤º**ï¼šè¿™äº›æŒ‡å¯¼åŸåˆ™æ—¨åœ¨å»ºç«‹ä¸€ä¸ªç§‘å­¦ã€å…¬å¹³çš„é¢„æµ‹è¯„ä¼°ç¯å¢ƒã€‚æˆ‘ä»¬æ¬¢è¿å›¢é˜Ÿé—´çš„æŠ€æœ¯äº¤æµå’Œæ–¹æ³•è®ºè®¨è®ºï¼Œå…±åŒæå‡é¢„æµ‹æ¨¡å‹çš„è´¨é‡å’Œå®ç”¨æ€§ã€‚

## å…¥é—¨æŒ‡å—

### æ–°å›¢é˜ŸåŠ å…¥

1. **æ³¨å†Œæ‚¨çš„æ¨¡å‹**ï¼šåœ¨ `model-metadata/` æ–‡ä»¶å¤¹ä¸­åˆ›å»ºæ¨¡å‹å…ƒæ•°æ®æ–‡ä»¶ï¼Œéµå¾ª[æ¨¡å‹å…ƒæ•°æ®æŒ‡å¯¼åŸåˆ™](model-metadata/README.md)
2. **æäº¤é¢„æµ‹**ï¼šæ¯å‘¨é¢„æµ‹åº”ä½œä¸ºCSVæ–‡ä»¶æäº¤åˆ° `model-output/` æ–‡ä»¶å¤¹ï¼Œéµå¾ª[æäº¤æŒ‡å¯¼åŸåˆ™](model-output/README.md)
3. **éªŒè¯**ï¼šæ‰€æœ‰æäº¤éƒ½é€šè¿‡GitHub Actionsè‡ªåŠ¨éªŒè¯ï¼Œä»¥ç¡®ä¿æ ¼å¼åˆè§„æ€§

### å¿«é€Ÿå…¥é—¨æ£€æŸ¥æ¸…å•

- [ ] é˜…è¯»[æ¨¡å‹å…ƒæ•°æ®è¦æ±‚](model-metadata/README.md)
- [ ] åˆ›å»ºæ‚¨çš„ `team-model.yml` å…ƒæ•°æ®æ–‡ä»¶
- [ ] æäº¤åŒ…å«æ‚¨å…ƒæ•°æ®çš„æ‹‰å–è¯·æ±‚
- [ ] æ ¹æ®[æ ¼å¼è§„èŒƒ](model-output/README.md)å‡†å¤‡æ‚¨çš„ç¬¬ä¸€ä¸ªé¢„æµ‹CSVæ–‡ä»¶
- [ ] åœ¨**åŒ—äº¬æ—¶é—´æ¯å‘¨ä¸‰23:59**å‰æäº¤å‘¨é¢„æµ‹

## äº‘ç«¯æ•°æ®è®¿é—®

ä¸ºç¡®ä¿å¯¹æœ¬ä¸­å¿ƒåˆ›å»ºå’Œæäº¤çš„æ•°æ®æœ‰æ›´å¤§çš„è®¿é—®æƒé™ï¼Œmodel-outputã€targetå’Œé…ç½®æ–‡ä»¶çš„å®æ—¶å‰¯æœ¬æ‰˜ç®¡åœ¨Hubverseçš„äºšé©¬é€Šç½‘ç»œæœåŠ¡ï¼ˆAWSï¼‰åŸºç¡€è®¾æ–½ä¸Šï¼Œå­˜å‚¨åœ¨å…¬å…±S3å­˜å‚¨æ¡¶ä¸­ï¼ˆå³å°†æ¨å‡ºï¼‰ã€‚

**æ³¨æ„**ï¼šä¸ºäº†é«˜æ•ˆå­˜å‚¨ï¼ŒS3ä¸­çš„æ‰€æœ‰model-outputæ–‡ä»¶éƒ½ä»¥parquetæ ¼å¼å­˜å‚¨ï¼Œå³ä½¿GitHubä»“åº“ä¸­çš„åŸå§‹ç‰ˆæœ¬æ˜¯.csvæ ¼å¼ã€‚

GitHubä»ç„¶æ˜¯æ“ä½œä¸­å¿ƒå’Œæ”¶é›†å»ºæ¨¡è€…é¢„æµ‹çš„ä¸»è¦æ¥å£ã€‚
ä½†æ˜¯ï¼ŒS3ä¸Šä¸­å¿ƒæ–‡ä»¶çš„é•œåƒæ˜¯åœ¨ä¸ä½¿ç”¨git/GitHubæˆ–å°†æ•´ä¸ªä¸­å¿ƒå…‹éš†åˆ°æœ¬åœ°æœºå™¨çš„æƒ…å†µä¸‹è®¿é—®ä¸­å¿ƒæ•°æ®çš„æœ€ä¾¿æ·æ–¹å¼ã€‚

ä¸‹é¢çš„éƒ¨åˆ†æ ¹æ®æ‚¨çš„ç›®æ ‡å’Œé¦–é€‰å·¥å…·æä¾›äº†è®¿é—®äº‘ç«¯ä¸­å¿ƒæ•°æ®çš„ç¤ºä¾‹ã€‚é€‰é¡¹åŒ…æ‹¬ï¼š

| è®¿é—®æ–¹æ³•              | æè¿°                                                                           |
| -------------------------- | ------------------------------------------------------------------------------------- |
| hubData (R)                | Hubverse Rå®¢æˆ·ç«¯å’Œç”¨äºè®¿é—®ä¸­å¿ƒæ•°æ®çš„Rä»£ç                                    |
| Polars (Python)            | ç”¨äºæ•°æ®æ“ä½œçš„Pythonå¼€æºåº“                                      |
| AWSå‘½ä»¤è¡Œæ¥å£ | å°†ä¸­å¿ƒæ•°æ®ä¸‹è½½åˆ°æ‚¨çš„æœºå™¨å¹¶ä½¿ç”¨hubDataæˆ–Polarsè¿›è¡Œæœ¬åœ°è®¿é—®          |

ä¸€èˆ¬æ¥è¯´ï¼Œç›´æ¥ä»S3è®¿é—®æ•°æ®ï¼ˆè€Œä¸æ˜¯å…ˆä¸‹è½½ï¼‰æ›´åŠ ä¾¿æ·ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ€§èƒ½è‡³å…³é‡è¦ï¼ˆä¾‹å¦‚ï¼Œæ‚¨æ­£åœ¨æ„å»ºäº¤äº’å¼å¯è§†åŒ–ï¼‰ï¼Œæˆ–è€…æ‚¨éœ€è¦ç¦»çº¿å·¥ä½œï¼Œæˆ‘ä»¬å»ºè®®å…ˆä¸‹è½½æ•°æ®ã€‚

<!-------------------------------------------------- hubData ------------------------------------------------------->

<details>

<summary>hubData (R)</summary>

[hubData](https://hubverse-org.github.io/hubData)ï¼ŒHubverse Rå®¢æˆ·ç«¯ï¼Œå¯ä»¥åˆ›å»ºäº¤äº’å¼ä¼šè¯æ¥è®¿é—®ã€è¿‡æ»¤å’Œè½¬æ¢å­˜å‚¨åœ¨S3ä¸­çš„ä¸­å¿ƒæ¨¡å‹è¾“å‡ºæ•°æ®ã€‚

å¦‚æœæ‚¨ç¬¦åˆä»¥ä¸‹æ¡ä»¶ï¼ŒhubDataæ˜¯ä¸€ä¸ªå¥½é€‰æ‹©ï¼š

- å·²ç»ä½¿ç”¨Rè¿›è¡Œæ•°æ®åˆ†æ
- æƒ³è¦ä»äº‘ç«¯äº¤äº’å¼æ¢ç´¢ä¸­å¿ƒæ•°æ®è€Œæ— éœ€ä¸‹è½½
- æƒ³è¦å°†ä¸­å¿ƒæ•°æ®çš„å­é›†ï¼ˆ*ä¾‹å¦‚*ï¼Œç‰¹å®šæ—¥æœŸæˆ–ç›®æ ‡çš„é¢„æµ‹ï¼‰ä¿å­˜åˆ°æœ¬åœ°æœºå™¨
- æƒ³è¦ä»¥ä¸åŒçš„æ–‡ä»¶æ ¼å¼ä¿å­˜ä¸­å¿ƒæ•°æ®ï¼ˆ*ä¾‹å¦‚*ï¼Œparquetè½¬.csvï¼‰

**æ³¨æ„**ï¼šS3è®¿é—®å°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¯ç”¨ã€‚

### å®‰è£…hubData

è¦å®‰è£…hubDataåŠå…¶ä¾èµ–é¡¹ï¼ˆåŒ…æ‹¬dplyrå’ŒarrowåŒ…ï¼‰ï¼Œè¯·éµå¾ª[hubDataæ–‡æ¡£ä¸­çš„è¯´æ˜](https://hubverse-org.github.io/hubData/#installation)ã€‚

### ä½¿ç”¨hubData

hubDataçš„[`connect_hub()`å‡½æ•°](https://hubverse-org.github.io/hubData/reference/connect_hub.html)è¿”å›ä¸€ä¸ª[Arrowå¤šæ–‡ä»¶æ•°æ®é›†](https://arrow.apache.org/docs/r/reference/Dataset.html)ï¼Œä»£è¡¨ä¸­å¿ƒçš„æ¨¡å‹è¾“å‡ºæ•°æ®ã€‚
æ•°æ®é›†å¯ä»¥ä½¿ç”¨dplyrè¿›è¡Œè¿‡æ»¤å’Œè½¬æ¢ï¼Œç„¶åä½¿ç”¨[`collect_hub()`å‡½æ•°](https://hubverse-org.github.io/hubData/reference/collect_hub.html)å®ç°ä¸ºæœ¬åœ°æ•°æ®æ¡†ã€‚


#### è®¿é—®ç›®æ ‡æ•°æ®

*[ä¸€æ—¦Hubverseç›®æ ‡æ•°æ®æ ‡å‡†æœ€ç»ˆç¡®å®šï¼ŒhubDataå°†æ›´æ–°ä»¥è®¿é—®ç›®æ ‡æ•°æ®ã€‚]*

#### è®¿é—®æ¨¡å‹è¾“å‡ºæ•°æ®

ä»¥ä¸‹æ˜¯ä½¿ç”¨hubDataè¿æ¥åˆ°S3ä¸Šçš„ä¸­å¿ƒå¹¶è¿‡æ»¤æ¨¡å‹è¾“å‡ºæ•°æ®çš„ç¤ºä¾‹ã€‚

```r
library(dplyr)
library(hubData)

bucket_name <- "hub-bucket-name"
hub_bucket <- s3_bucket(bucket_name)
hub_con <- hubData::connect_hub(hub_bucket, file_format = "parquet", skip_checks = TRUE)
hub_con %>%
  dplyr::filter(location == "MA", output_type == "quantile") %>%
  hubData::collect_hub()

```

- [å®Œæ•´hubDataæ–‡æ¡£](https://hubverse-org.github.io/hubData/)

</details>

<!--------------------------------------------------- Polars ------------------------------------------------------->

<details>

<summary>Polars (Python)</summary>

Hubverseå›¢é˜Ÿç›®å‰æ­£åœ¨å¼€å‘Pythonå®¢æˆ·ç«¯ï¼ˆhubDataPyï¼‰ã€‚åœ¨hubDataPyå‡†å¤‡å°±ç»ªä¹‹å‰ï¼Œ[Polars](https://pola.rs/)åº“æ˜¯åœ¨S3ä¸­ä½¿ç”¨ä¸­å¿ƒæ•°æ®çš„å¥½é€‰æ‹©ã€‚
ä¸pandasç±»ä¼¼ï¼ŒPolarsåŸºäºæ•°æ®æ¡†å’Œåºåˆ—ã€‚ä½†æ˜¯ï¼ŒPolarså…·æœ‰æ›´ç›´è§‚çš„APIï¼Œä¸“ä¸ºå¤„ç†å¤§äºå†…å­˜çš„æ•°æ®é›†è€Œè®¾è®¡ã€‚

Pandasç”¨æˆ·å¯ä»¥å¦‚ä¸‹æ‰€è¿°è®¿é—®ä¸­å¿ƒæ•°æ®ï¼Œç„¶åä½¿ç”¨`to_pandas()`æ–¹æ³•å°†Polarsæ•°æ®æ¡†è½¬æ¢ä¸ºpandasæ ¼å¼ã€‚

å¦‚æœæ‚¨ç¬¦åˆä»¥ä¸‹æ¡ä»¶ï¼ŒPolarsæ˜¯ä¸€ä¸ªå¥½é€‰æ‹©ï¼š

- å·²ç»ä½¿ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æ
- æƒ³è¦ä»äº‘ç«¯äº¤äº’å¼æ¢ç´¢ä¸­å¿ƒæ•°æ®è€Œæ— éœ€ä¸‹è½½
- æƒ³è¦å°†ä¸­å¿ƒæ•°æ®çš„å­é›†ï¼ˆ*ä¾‹å¦‚*ï¼Œç‰¹å®šæ—¥æœŸæˆ–ç›®æ ‡çš„é¢„æµ‹ï¼‰ä¿å­˜åˆ°æœ¬åœ°æœºå™¨
- æƒ³è¦ä»¥ä¸åŒçš„æ–‡ä»¶æ ¼å¼ä¿å­˜ä¸­å¿ƒæ•°æ®ï¼ˆ*ä¾‹å¦‚*ï¼Œparquetè½¬.csvï¼‰

### å®‰è£…polars

ä½¿ç”¨pipå®‰è£…Polarsï¼š

```sh
pip install polars
```

### ä½¿ç”¨Polars

ä¸‹é¢çš„ç¤ºä¾‹ä½¿ç”¨Polarsçš„[`scan_parquet()`å‡½æ•°](https://docs.pola.rs/api/python/dev/reference/api/polars.scan_parquet.html)ï¼Œå®ƒè¿”å›ä¸€ä¸ª[LazyFrame](https://docs.pola.rs/api/python/stable/reference/lazyframe/index.html)ã€‚
LazyFramesåœ¨å¿…è¦æ—¶æ‰æ‰§è¡Œè®¡ç®—ï¼Œå› æ­¤æ‚¨å¯¹æ•°æ®åº”ç”¨çš„ä»»ä½•è¿‡æ»¤å’Œè½¬æ¢éƒ½ä¼šå»¶è¿Ÿåˆ°æ˜¾å¼çš„[`collect()`æ“ä½œ](https://docs.pola.rs/api/python/stable/reference/lazyframe/api/polars.LazyFrame.collect.html#polars.LazyFrame.collect)ã€‚

#### è®¿é—®ç›®æ ‡æ•°æ®

å°†æ‰€æœ‰oracle-outputæ–‡ä»¶åˆå¹¶åˆ°å•ä¸ªDataFrameä¸­ã€‚

```python
import polars as pl

oracle_data = pl.scan_parquet(
    # ä¸‹é¢s3é“¾æ¥çš„ç»“æ„å°†å–å†³äºæ‚¨çš„ä¸­å¿ƒå¦‚ä½•ç»„ç»‡ç›®æ ‡æ•°æ®
    "s3://[hub-bucket-name]/target-data/oracle-output/*/*.parquet",
    storage_options={"skip_signature": "true"}
)

# æ ¹æ®éœ€è¦è¿›è¡Œè¿‡æ»¤å’Œè½¬æ¢ï¼Œå¹¶æ”¶é›†åˆ°æ•°æ®æ¡†ä¸­ï¼Œä¾‹å¦‚ï¼š
oracle_dataframe = oracle_data.filter(pl.col("location") == "MA").collect()
```

#### è®¿é—®æ¨¡å‹è¾“å‡ºæ•°æ®

è·å–ç‰¹å®šå›¢é˜Ÿçš„model-outputæ–‡ä»¶ï¼ˆæ‰€æœ‰è½®æ¬¡ï¼‰ã€‚
æ­¤ç¤ºä¾‹ä½¿ç”¨[å…¨å±€æ¨¡å¼å°†å¤šä¸ªæ–‡ä»¶è¯»å…¥å•ä¸ªæ•°æ®é›†](https://docs.pola.rs/user-guide/io/multiple/#reading-into-a-single-dataframe)ã€‚

```python
import polars as pl

lf = pl.scan_parquet(
    "s3://[hub-bucket-name]/model-output/[å»ºæ¨¡å›¢é˜Ÿåç§°]/*.parquet",
    storage_options={"skip_signature": "true"}
)
```

#### ä½¿ç”¨åˆ†åŒºï¼ˆhive-styleï¼‰

å¦‚æœæ‚¨çš„æ•°æ®ä½¿ç”¨hive-styleåˆ†åŒºï¼ŒPolarså¯ä»¥åœ¨è¯»å–æ•°æ®ä¹‹å‰ä½¿ç”¨åˆ†åŒºæ¥è¿‡æ»¤æ•°æ®ã€‚

```python
from datetime import datetime
import polars as pl

oracle_data = pl.scan_parquet(
    "s3://[hub-bucket-name]/target-data/oracle-output/",
    hive_partitioning=True,
    storage_options={"skip_signature": "true"}) \
.filter(pl.col("nowcast_date") == datetime(2025, 2, 5)) \
.collect()
```

- [Polars Python APIå®Œæ•´æ–‡æ¡£](https://docs.pola.rs/api/python/stable/reference/)

</details>

## è‡´è°¢

ä¸­å›½ç–¾æ§ä¸­å¿ƒ

æœ¬ä»“åº“éµå¾ª[hubverse](https://hubverse.io)æ¦‚è¿°çš„æŒ‡å¯¼åŸåˆ™å’Œæ ‡å‡†ï¼Œhubverseä¸ºå»ºæ¨¡ä¸­å¿ƒæä¾›ä¸€å¥—æ•°æ®æ ¼å¼å’Œå¼€æºå·¥å…·ã€‚